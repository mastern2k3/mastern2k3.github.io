<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Buffs, buffs everywhere | Gato Malo</title>
<meta name=keywords content="throne">
<meta name=description content="The task of adding character buffs to the game required adding some cool complexities to the state engine, including stat effects, allowing transient alterations to the character&rsquo;s stats, and state slots enabling characters to act-out multiple effects at a time.
Buff system and triggers The buff system took much thinking but little actual code, I ended up designing it as part of the already existing character state machine module.
The task leading to adding the buff system was implementing an &ldquo;enrage&rdquo; mechanic, causing an enemy to apply a buff to himself when it&rsquo;s hp falls under a certain amount, for that, I added trigger semantics allowing me to implement various types of triggers.">
<meta name=author content="Nitzan Zada">
<link rel=canonical href=https://gatomalo.dev/blog/2019/06/28/buffs-everywhere/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.4c0edbddf6d9d86d1a8f4c9fa6cf34bd2dd8d46c62c5d0f5dbee4a15c69e3ccd.css integrity="sha256-TA7b3fbZ2G0aj0yfps80vS3Y1GxixdD12+5KFcaePM0=" rel="preload stylesheet" as=style>
<link rel=preload href=/img/logo.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://gatomalo.dev/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://gatomalo.dev/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://gatomalo.dev/favicon-32x32.png>
<link rel=apple-touch-icon href=https://gatomalo.dev/apple-touch-icon.png>
<link rel=mask-icon href=https://gatomalo.dev/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.92.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-142124854-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="Buffs, buffs everywhere">
<meta property="og:description" content="The task of adding character buffs to the game required adding some cool complexities to the state engine, including stat effects, allowing transient alterations to the character&rsquo;s stats, and state slots enabling characters to act-out multiple effects at a time.
Buff system and triggers The buff system took much thinking but little actual code, I ended up designing it as part of the already existing character state machine module.
The task leading to adding the buff system was implementing an &ldquo;enrage&rdquo; mechanic, causing an enemy to apply a buff to himself when it&rsquo;s hp falls under a certain amount, for that, I added trigger semantics allowing me to implement various types of triggers.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://gatomalo.dev/blog/2019/06/28/buffs-everywhere/"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2019-06-28T14:10:00+03:00">
<meta property="article:modified_time" content="2019-06-28T14:10:00+03:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Buffs, buffs everywhere">
<meta name=twitter:description content="The task of adding character buffs to the game required adding some cool complexities to the state engine, including stat effects, allowing transient alterations to the character&rsquo;s stats, and state slots enabling characters to act-out multiple effects at a time.
Buff system and triggers The buff system took much thinking but little actual code, I ended up designing it as part of the already existing character state machine module.
The task leading to adding the buff system was implementing an &ldquo;enrage&rdquo; mechanic, causing an enemy to apply a buff to himself when it&rsquo;s hp falls under a certain amount, for that, I added trigger semantics allowing me to implement various types of triggers.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://gatomalo.dev/blog/"},{"@type":"ListItem","position":2,"name":"Buffs, buffs everywhere","item":"https://gatomalo.dev/blog/2019/06/28/buffs-everywhere/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Buffs, buffs everywhere","name":"Buffs, buffs everywhere","description":"The task of adding character buffs to the game required adding some cool complexities to the state engine, including stat effects, allowing transient alterations to the character\u0026rsquo;s stats, and state slots enabling characters to act-out multiple effects at a time.\nBuff system and triggers The buff system took much thinking but little actual code, I ended up designing it as part of the already existing character state machine module.\nThe task leading to adding the buff system was implementing an \u0026ldquo;enrage\u0026rdquo; mechanic, causing an enemy to apply a buff to himself when it\u0026rsquo;s hp falls under a certain amount, for that, I added trigger semantics allowing me to implement various types of triggers.","keywords":["throne"],"articleBody":"The task of adding character buffs to the game required adding some cool complexities to the state engine, including stat effects, allowing transient alterations to the character’s stats, and state slots enabling characters to act-out multiple effects at a time.\nBuff system and triggers The buff system took much thinking but little actual code, I ended up designing it as part of the already existing character state machine module.\nThe task leading to adding the buff system was implementing an “enrage” mechanic, causing an enemy to apply a buff to himself when it’s hp falls under a certain amount, for that, I added trigger semantics allowing me to implement various types of triggers.\nTrigger semantics were designed with boss encounters in mind so that bosses could play out different phases of an encounter based on different triggers.\nStat effects Although currently the damage inflicted by melee attacks is a simple flat value associated with the character, I wanted to add a semantic allowing me to apply a transient change to it.\nStat effects simply allow for the adding / removing of stat altering components that trigger a recalculation of the character’s effective stats when applied.\nThe “enrage” buff described above uses a stat effect, adding 15 melee damage to the effected character.\nOn-the-fly character creation This might not look too glamorous but it is an important milestone for cooler features I want to have, like:\n Bosses summoning adds Enemy “Nests” that keep spawning enemies unless destroyed Character abilities that spawn allies  Small Changes   Version imprint - Build process now “watermarks” a version string based on version control tags and hashes, visible also on the client display.\n  Heals cause aggro - Friendly heals cause aggro to nearby enemies and may redirect attention to the healer.\n  Cast breaking - Cast-breaking semantics now enable abilities and buffs to break spell-casting.\n  ","wordCount":"307","inLanguage":"en","datePublished":"2019-06-28T14:10:00+03:00","dateModified":"2019-06-28T14:10:00+03:00","author":{"@type":"Person","name":"Nitzan Zada"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://gatomalo.dev/blog/2019/06/28/buffs-everywhere/"},"publisher":{"@type":"Organization","name":"Gato Malo","logo":{"@type":"ImageObject","url":"https://gatomalo.dev/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://gatomalo.dev/ accesskey=h title="Gato Malo (Alt + H)">
<img src=https://gatomalo.dev/img/logo.png alt=logo aria-label=logo height=" 30px">Gato Malo</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://gatomalo.dev/about/ title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://gatomalo.dev/blog/ title=Blog>
<span>Blog</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Buffs, buffs everywhere
</h1>
<div class=post-meta><span title="2019-06-28 14:10:00 +0300 +0300">June 28, 2019</span>&nbsp;·&nbsp;Nitzan Zada
</div>
</header>
<div class=post-content><p>The task of adding character buffs to the game required adding some cool
complexities to the state engine, including stat effects, allowing transient
alterations to the character&rsquo;s stats, and state slots enabling characters to
act-out multiple effects at a time.</p>
<h3 id=buff-system-and-triggers>Buff system and triggers<a hidden class=anchor aria-hidden=true href=#buff-system-and-triggers>#</a></h3>
<p><img loading=lazy src=enrage_triggered.gif alt="Enrage triggered">
</p>
<p>The buff system took much thinking but little actual code, I ended up designing
it as part of the already existing character state machine module.</p>
<p>The task leading to adding the buff system was implementing an &ldquo;enrage&rdquo; mechanic,
causing an enemy to apply a buff to himself when it&rsquo;s hp falls under a certain
amount, for that, I added trigger semantics allowing me to implement various
types of triggers.</p>
<p><img loading=lazy src=dot.gif#center alt="Damage over time on &amp;lsquo;smash&amp;rsquo;">
</p>
<p>Trigger semantics were designed with boss encounters in mind so that bosses
could play out different phases of an encounter based on different triggers.</p>
<h3 id=stat-effects>Stat effects<a hidden class=anchor aria-hidden=true href=#stat-effects>#</a></h3>
<p>Although currently the damage inflicted by melee attacks is a simple flat value
associated with the character, I wanted to add a semantic allowing me to apply a
transient change to it.</p>
<p>Stat effects simply allow for the adding / removing of stat altering components
that trigger a recalculation of the character&rsquo;s effective stats when applied.</p>
<p>The &ldquo;enrage&rdquo; buff described above uses a stat effect, adding 15 melee damage to
the effected character.</p>
<h3 id=on-the-fly-character-creation>On-the-fly character creation<a hidden class=anchor aria-hidden=true href=#on-the-fly-character-creation>#</a></h3>
<p><img loading=lazy src=instance_char.gif#center alt="Ability creating character">
</p>
<p>This might not look too glamorous but it is an important milestone for cooler
features I want to have, like:</p>
<ul>
<li>Bosses summoning adds</li>
<li>Enemy &ldquo;Nests&rdquo; that keep spawning enemies unless destroyed</li>
<li>Character abilities that spawn allies</li>
</ul>
<h2 id=small-changes>Small Changes<a hidden class=anchor aria-hidden=true href=#small-changes>#</a></h2>
<ul>
<li>
<p><strong>Version imprint</strong> - Build process now &ldquo;watermarks&rdquo; a version string based on
version control tags and hashes, visible also on the client display.</p>
</li>
<li>
<p><strong>Heals cause aggro</strong> - Friendly heals cause aggro to nearby enemies and may
redirect attention to the healer.</p>
</li>
<li>
<p><strong>Cast breaking</strong> - Cast-breaking semantics now enable abilities and buffs to
break spell-casting.</p>
</li>
</ul>
<p><img loading=lazy src=break_spell.gif#center alt="Cast breaking">
</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://gatomalo.dev/tags/throne/>Throne of Mithril</a></li>
</ul>
</footer><div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//gato-malo.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://gatomalo.dev/>Gato Malo</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/mastern2k3/hugo-PaperMod-Nord rel=noopener target=_blank>PaperMod-Nord</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>