<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Error Monitoring in Godot using Sentry | Gato Malo</title>
<meta name=keywords content="godot,sentry,monitoring,error monitoring">
<meta name=description content="I&rsquo;m a big fan of the Godot game engine, and lately, since players have been testing the game more often, I&rsquo;ve decided to add some monitoring solution to get a better view of what&rsquo;s failing players as they try to play.
In this post I&rsquo;ll show how to integrate Sentry&rsquo;s .Net SDK in Godot and use it to receive usage reports and error monitoring.
What&rsquo;s Sentry? Sentry is an open-source error monitoring tool I picked up on a while ago.">
<meta name=author content>
<link rel=canonical href=https://gatomalo.dev/blog/2020/03/21/error-monitoring-godot-sentry/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.4c0edbddf6d9d86d1a8f4c9fa6cf34bd2dd8d46c62c5d0f5dbee4a15c69e3ccd.css integrity="sha256-TA7b3fbZ2G0aj0yfps80vS3Y1GxixdD12+5KFcaePM0=" rel="preload stylesheet" as=style>
<link rel=preload href=/img/logo.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://gatomalo.dev/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://gatomalo.dev/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://gatomalo.dev/favicon-32x32.png>
<link rel=apple-touch-icon href=https://gatomalo.dev/apple-touch-icon.png>
<link rel=mask-icon href=https://gatomalo.dev/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.92.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-142124854-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="Error Monitoring in Godot using Sentry">
<meta property="og:description" content="I&rsquo;m a big fan of the Godot game engine, and lately, since players have been testing the game more often, I&rsquo;ve decided to add some monitoring solution to get a better view of what&rsquo;s failing players as they try to play.
In this post I&rsquo;ll show how to integrate Sentry&rsquo;s .Net SDK in Godot and use it to receive usage reports and error monitoring.
What&rsquo;s Sentry? Sentry is an open-source error monitoring tool I picked up on a while ago.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://gatomalo.dev/blog/2020/03/21/error-monitoring-godot-sentry/"><meta property="article:section" content="blog">
<meta property="article:published_time" content="2020-03-21T19:53:04+02:00">
<meta property="article:modified_time" content="2020-03-21T19:53:04+02:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Error Monitoring in Godot using Sentry">
<meta name=twitter:description content="I&rsquo;m a big fan of the Godot game engine, and lately, since players have been testing the game more often, I&rsquo;ve decided to add some monitoring solution to get a better view of what&rsquo;s failing players as they try to play.
In this post I&rsquo;ll show how to integrate Sentry&rsquo;s .Net SDK in Godot and use it to receive usage reports and error monitoring.
What&rsquo;s Sentry? Sentry is an open-source error monitoring tool I picked up on a while ago.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://gatomalo.dev/blog/"},{"@type":"ListItem","position":2,"name":"Error Monitoring in Godot using Sentry","item":"https://gatomalo.dev/blog/2020/03/21/error-monitoring-godot-sentry/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Error Monitoring in Godot using Sentry","name":"Error Monitoring in Godot using Sentry","description":"I\u0026rsquo;m a big fan of the Godot game engine, and lately, since players have been testing the game more often, I\u0026rsquo;ve decided to add some monitoring solution to get a better view of what\u0026rsquo;s failing players as they try to play.\nIn this post I\u0026rsquo;ll show how to integrate Sentry\u0026rsquo;s .Net SDK in Godot and use it to receive usage reports and error monitoring.\nWhat\u0026rsquo;s Sentry? Sentry is an open-source error monitoring tool I picked up on a while ago.","keywords":["godot","sentry","monitoring","error monitoring"],"articleBody":" I’m a big fan of the Godot game engine, and lately, since players have been testing the game more often, I’ve decided to add some monitoring solution to get a better view of what’s failing players as they try to play.\nIn this post I’ll show how to integrate Sentry’s .Net SDK in Godot and use it to receive usage reports and error monitoring.\nWhat’s Sentry? Sentry is an open-source error monitoring tool I picked up on a while ago.\nI initially started using it because it was open-source and I was quite the cheapskate, but, it really is an awesome and visually delightful tool.\nAside from collecting error reports and alerting you when the application fails, it makes it simple to integrate information and events you care about in those reports. Also, it’s fairly easy to integrate and get started collecting data with, even if you’re not that much of a friend to coding.\nSo, if you want a dashboard filled with reports about how your game crashed, to who, why and what were they doing leading to the crash, keep reading.\nDependencies First, let’s grab the required binaries. Installing the Sentry SDK collects a few other assemblies so I added all of them to one packages.config for convenience:\n   id=\"Sentry\" version=\"2.1.0\" targetFramework=\"net45\" /  id=\"Sentry.Protocol\" version=\"2.1.0\" targetFramework=\"net45\" /  id=\"Sentry.PlatformAbstractions\" version=\"1.1.0.0\" targetFramework=\"net45\" /  id=\"System.Collections.Immutable\" version=\"1.5.0\" targetFramework=\"net45\" /  Run NuGet to fetch all those into your project’s ./packages/ folder.\n$ mono nuget.exe restore  If you don’t have NuGet yet you can grab it here.\nThe Windows x86 Commandline version is runnable using mono.\n Add references to the Sentry assemblies to your project:\n  Include=\"Sentry, Version=2.1.0.0\" $(ProjectDir)/packages/Sentry.2.1.0/lib/net461/Sentry.dll True   Include=\"Sentry.Protocol, Version=2.1.0.0\" $(ProjectDir)/packages/Sentry.Protocol.2.1.0/lib/net46/Sentry.Protocol.dll True   Include=\"Sentry.PlatformAbstractions, Version=1.1.0.0\" $(ProjectDir)/packages/Sentry.PlatformAbstractions.1.1.0/lib/net471/Sentry.PlatformAbstractions.dll True   Include=\"System.Collections.Immutable, Version=1.2.3.0\" $(ProjectDir)/packages/System.Collections.Immutable.1.5.0/lib/portable-net45+win8+wp8+wpa81/System.Collections.Immutable.dll True   Initialization Using Godot we don’t really have an initialization section so I created a dedicated node (here as SentryController) to hold the Sentry initialization logic.\n Pay close attention to the node placement in the scene tree.\nThe Sentry controller node must come before any application nodes. Godot invokes their _Ready() methods according to their ordering on the tree, and any exception thrown before SDK init will not be reported.\n After creating an account and a project Sentry will suggest an initialization clause with your project’s Dsn, similar to this:\nusing (SentrySdk.Init(\"https://451cf9b0fd9e4f0294a0d15b6c36bce2@sentry.io/5170198\")) { // App code }  After creating a project this page will contain code examples with your project’s Dsn in place.\n So after adding it to your node it should look somewhat like this.\npublic class SentryController : Node { public override void _Ready() { SentrySdk.Init(o = { o.Dsn = new Dsn(\"https://451cf9b0fd9e4f0294a0d15b6c36bce2@sentry.io/5170198\"); }); } } Error reporting Now that the client is set up, any unhandled exceptions thrown will get reported to the sentry API, and appear on your dashboard with a full trace.\nFor example, lets set a button that throws an exception:\npublic class App : Node2D { private void _on_CrashButton_pressed() { throw new Exception(\"Oh lord jesus it's a fire!\"); } } Which after getting pressed will cause an error to appear on your issue dashboard.\nBreadcrumbs A neat feature of Sentry that I had to cover.\nThis allows you to log the user’s behavior, potentially, leading to the error. Giving you a better view into what exactly happened before the crash.\nThe code is fairly simple, for example, lets log a button click (exciting, I know :P).\npublic class App : Node2D { ... private void _on_AwesomeButton_pressed() { SentrySdk.AddBreadcrumb(\"Awesome button clicked\"); } } After a few clicks on this button, and then, a hit to the ol' crashing button, we’ll get this neat report:\nExample Project I’ve prepared an example project demonstrating the Sentry integration here:\nhttps://github.com/mastern2k3/godot-sentry-example\nThere is a small caveat for people looking to export for Android, read ahead.\nAndroid Although making all this goodness to work on Android should’ve been an export prest away, things turned out to be trickier.\nThe Android prest kept failing the mono assembly preparation phase because of an apparent missing assembly named System.Web.\nERROR: get_assembly_dependencies: Cannot load assembly (refonly): 'System.Web'. At: modules/mono/editor/godotsharp_export.cpp:93. ERROR: get_assembly_dependencies: Cannot load one of the dependencies for the assembly: 'Sentry'. At: modules/mono/editor/godotsharp_export.cpp:98. Finding the answer to this little bugger took me a good two days of research, trial and error, so I’ll cut to the chase.\nAfter digging through the .Net Sentry SDK I found out that the System.Web assembly (required by the net461 variant of the Sentry.dll assembly) is not a strict requirement, and that on other framework outputs its reference is omitted.\nSo, on the last trial, I ended up forking the SDK in an attempt to produce a Sentry.dll that did not reference System.Web.\nYou can download a compiled version of it here.\nImportant: The example project references the compiled fork version so it appears as such in the .csproj file:\n Include=\"Sentry, Version=2.1.0.0\" $(ProjectDir)/../forks/sentry-dotnet/src/Sentry/bin/Release/net461/Sentry.dll $(ProjectDir)/packages/Sentry.2.1.0/lib/net461/Sentry.dll -- True  If you’re not interested in any of this Android nonsense you can comment / uncomment whichever line fits your needs.\nOther Sentry related stuff you should check out   Sentry Scopes - these enable you to add more info (like user identification) as application usage progresses.\n  Self hosting Sentry - yeah, you can do that.\n  ","wordCount":"878","inLanguage":"en","datePublished":"2020-03-21T19:53:04+02:00","dateModified":"2020-03-21T19:53:04+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://gatomalo.dev/blog/2020/03/21/error-monitoring-godot-sentry/"},"publisher":{"@type":"Organization","name":"Gato Malo","logo":{"@type":"ImageObject","url":"https://gatomalo.dev/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://gatomalo.dev/ accesskey=h title="Gato Malo (Alt + H)">
<img src=https://gatomalo.dev/img/logo.png alt=logo aria-label=logo height=" 30px">Gato Malo</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://gatomalo.dev/about/ title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://gatomalo.dev/blog/ title=Blog>
<span>Blog</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Error Monitoring in Godot using Sentry
</h1>
<div class=post-meta><span title="2020-03-21 19:53:04 +0200 +0200">March 21, 2020</span>
</div>
</header>
<div class=post-content><figure class="align-center darksafe">
<img loading=lazy src=sentry-glyph-dark.png#center>
</figure>
<p>I&rsquo;m a big fan of the Godot game engine, and lately, since players have been
testing the game more often, I&rsquo;ve decided to add some monitoring solution to
get a better view of what&rsquo;s failing players as they try to play.</p>
<p>In this post I&rsquo;ll show how to integrate Sentry&rsquo;s .Net SDK in Godot and use
it to receive usage reports and error monitoring.</p>
<h2 id=whats-sentry>What&rsquo;s Sentry?<a hidden class=anchor aria-hidden=true href=#whats-sentry>#</a></h2>
<p>Sentry is an open-source error monitoring tool I picked up on a while ago.</p>
<p>I initially started using it because it was open-source and I was quite the
cheapskate, but, it really is an <strong>awesome</strong> and <strong>visually delightful</strong> tool.</p>
<p>Aside from collecting error reports and alerting you when the application fails,
it makes it simple to integrate information and events <strong>you</strong> care about in
those reports. Also, it&rsquo;s fairly <strong>easy to integrate</strong> and get started
collecting data with, <strong>even if</strong> you&rsquo;re not that much of a friend to coding.</p>
<p><img loading=lazy src=sentry_pic.jpg alt=Sentry>
</p>
<p>So, if you want a dashboard filled with reports about <strong>how your game crashed</strong>,
to <strong>who</strong>, <strong>why</strong> and what were they doing leading to the crash,
<strong>keep reading.</strong></p>
<h2 id=dependencies>Dependencies<a hidden class=anchor aria-hidden=true href=#dependencies>#</a></h2>
<p>First, let&rsquo;s grab the required binaries. Installing the Sentry SDK collects a
few other assemblies so I added all of them to one <code>packages.config</code> for
convenience:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
<span style=color:#f92672>&lt;packages&gt;</span>
  <span style=color:#f92672>&lt;package</span> <span style=color:#a6e22e>id=</span><span style=color:#e6db74>&#34;Sentry&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;2.1.0&#34;</span> <span style=color:#a6e22e>targetFramework=</span><span style=color:#e6db74>&#34;net45&#34;</span> <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;package</span> <span style=color:#a6e22e>id=</span><span style=color:#e6db74>&#34;Sentry.Protocol&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;2.1.0&#34;</span> <span style=color:#a6e22e>targetFramework=</span><span style=color:#e6db74>&#34;net45&#34;</span> <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;package</span> <span style=color:#a6e22e>id=</span><span style=color:#e6db74>&#34;Sentry.PlatformAbstractions&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1.1.0.0&#34;</span> <span style=color:#a6e22e>targetFramework=</span><span style=color:#e6db74>&#34;net45&#34;</span> <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;package</span> <span style=color:#a6e22e>id=</span><span style=color:#e6db74>&#34;System.Collections.Immutable&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1.5.0&#34;</span> <span style=color:#a6e22e>targetFramework=</span><span style=color:#e6db74>&#34;net45&#34;</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;/packages&gt;</span>
</code></pre></div><p>Run <strong>NuGet</strong> to fetch all those into your project&rsquo;s <code>./packages/</code> folder.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ mono nuget.exe restore
</code></pre></div><blockquote>
<p>If you don&rsquo;t have <strong>NuGet</strong> yet you can grab it <a href=https://www.nuget.org/downloads>here</a>.<br>
The <strong>Windows x86 Commandline</strong> version is runnable using mono.</p>
</blockquote>
<p>Add references to the Sentry assemblies to your project:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;ItemGroup&gt;</span>

  <span style=color:#f92672>&lt;Reference</span> <span style=color:#a6e22e>Include=</span><span style=color:#e6db74>&#34;Sentry, Version=2.1.0.0&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;HintPath&gt;</span>$(ProjectDir)/packages/Sentry.2.1.0/lib/net461/Sentry.dll<span style=color:#f92672>&lt;/HintPath&gt;</span>
    <span style=color:#f92672>&lt;Private&gt;</span>True<span style=color:#f92672>&lt;/Private&gt;</span>
  <span style=color:#f92672>&lt;/Reference&gt;</span>

  <span style=color:#f92672>&lt;Reference</span> <span style=color:#a6e22e>Include=</span><span style=color:#e6db74>&#34;Sentry.Protocol, Version=2.1.0.0&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;HintPath&gt;</span>$(ProjectDir)/packages/Sentry.Protocol.2.1.0/lib/net46/Sentry.Protocol.dll<span style=color:#f92672>&lt;/HintPath&gt;</span>
    <span style=color:#f92672>&lt;Private&gt;</span>True<span style=color:#f92672>&lt;/Private&gt;</span>
  <span style=color:#f92672>&lt;/Reference&gt;</span>

  <span style=color:#f92672>&lt;Reference</span> <span style=color:#a6e22e>Include=</span><span style=color:#e6db74>&#34;Sentry.PlatformAbstractions, Version=1.1.0.0&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;HintPath&gt;</span>$(ProjectDir)/packages/Sentry.PlatformAbstractions.1.1.0/lib/net471/Sentry.PlatformAbstractions.dll<span style=color:#f92672>&lt;/HintPath&gt;</span>
    <span style=color:#f92672>&lt;Private&gt;</span>True<span style=color:#f92672>&lt;/Private&gt;</span>
  <span style=color:#f92672>&lt;/Reference&gt;</span>

  <span style=color:#f92672>&lt;Reference</span> <span style=color:#a6e22e>Include=</span><span style=color:#e6db74>&#34;System.Collections.Immutable, Version=1.2.3.0&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;HintPath&gt;</span>$(ProjectDir)/packages/System.Collections.Immutable.1.5.0/lib/portable-net45+win8+wp8+wpa81/System.Collections.Immutable.dll<span style=color:#f92672>&lt;/HintPath&gt;</span>
    <span style=color:#f92672>&lt;Private&gt;</span>True<span style=color:#f92672>&lt;/Private&gt;</span>
  <span style=color:#f92672>&lt;/Reference&gt;</span>

<span style=color:#f92672>&lt;/ItemGroup&gt;</span>
</code></pre></div><h2 id=initialization>Initialization<a hidden class=anchor aria-hidden=true href=#initialization>#</a></h2>
<p>Using Godot we don&rsquo;t really have an initialization section so I created a
dedicated node (here as <code>SentryController</code>) to hold the Sentry initialization
logic.</p>
<p><img loading=lazy src=sentry_controller_node.png#center alt="Sentry Controller Node">
</p>
<blockquote>
<p><strong>Pay close attention</strong> to the node placement in the scene tree.</p>
<p>The Sentry controller node must come before any application nodes.
Godot invokes their <code>_Ready()</code> methods according to their ordering on the tree,
and any exception thrown before SDK init will <strong>not be reported</strong>.</p>
</blockquote>
<p>After creating an account and a project Sentry will suggest an initialization
clause with your project&rsquo;s <strong>Dsn</strong>, similar to this:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>using</span> (SentrySdk.Init(<span style=color:#e6db74>&#34;https://451cf9b0fd9e4f0294a0d15b6c36bce2@sentry.io/5170198&#34;</span>)) {
    <span style=color:#75715e>// App code
</span><span style=color:#75715e></span>}
</code></pre></div><blockquote>
<p>After creating a project <a href="https://docs.sentry.io/error-reporting/quickstart/?platform=csharp">this page</a> will contain code
examples with your project&rsquo;s Dsn in place.</p>
</blockquote>
<p>So after adding it to your node it should look somewhat like this.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SentryController</span> : Node {

    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>void</span> <span style=color:#ae81ff>_</span>Ready() {

        SentrySdk.Init(o =&gt; {
            o.Dsn = <span style=color:#66d9ef>new</span> Dsn(<span style=color:#e6db74>&#34;https://451cf9b0fd9e4f0294a0d15b6c36bce2@sentry.io/5170198&#34;</span>);
        });
    }
}
</code></pre></div><h2 id=error-reporting>Error reporting<a hidden class=anchor aria-hidden=true href=#error-reporting>#</a></h2>
<p>Now that the client is set up, any unhandled exceptions thrown will get
reported to the sentry API, and appear on your dashboard with a full trace.</p>
<p>For example, lets set a button that throws an exception:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>App</span> : Node2D {

	<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#ae81ff>_</span>on_CrashButton_pressed() {
		<span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception(<span style=color:#e6db74>&#34;Oh lord jesus it&#39;s a fire!&#34;</span>);
	}
}
</code></pre></div><p>Which after getting pressed will cause an error to appear on your issue
dashboard.</p>
<p><img loading=lazy src=issue_dashboard_error.png#center alt="Error Issue">
</p>
<h2 id=breadcrumbs>Breadcrumbs<a hidden class=anchor aria-hidden=true href=#breadcrumbs>#</a></h2>
<p>A neat feature of Sentry that I had to cover.</p>
<p>This allows you to log the user&rsquo;s behavior, potentially, leading to the error.
Giving you a better view into what exactly happened before the crash.</p>
<p>The code is fairly simple, for example, lets log a button click <em>(exciting, I
know :P)</em>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>App</span> : Node2D {

    ...

    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#ae81ff>_</span>on_AwesomeButton_pressed() {
        SentrySdk.AddBreadcrumb(<span style=color:#e6db74>&#34;Awesome button clicked&#34;</span>);
    }
}
</code></pre></div><p>After a few clicks on this button, and then, a hit to the ol' crashing button,
we&rsquo;ll get this neat report:</p>
<p><img loading=lazy src=sentry_breadcrumbs.png alt="Sentry breadcrumbs">
</p>
<h2 id=example-project>Example Project<a hidden class=anchor aria-hidden=true href=#example-project>#</a></h2>
<p>I&rsquo;ve prepared an example project demonstrating the Sentry integration here:</p>
<p><a href=https://github.com/mastern2k3/godot-sentry-example>https://github.com/mastern2k3/godot-sentry-example</a></p>
<p>There is a small caveat for people looking to export for Android, read ahead.</p>
<h2 id=android>Android<a hidden class=anchor aria-hidden=true href=#android>#</a></h2>
<p>Although making all this goodness to work on Android should&rsquo;ve been an export
prest away, things turned out to be trickier.</p>
<p>The Android prest kept failing the mono assembly preparation phase because of
an apparent missing assembly named <code>System.Web</code>.</p>
<pre tabindex=0><code>ERROR: get_assembly_dependencies: Cannot load assembly (refonly): 'System.Web'.
   At: modules/mono/editor/godotsharp_export.cpp:93.
ERROR: get_assembly_dependencies: Cannot load one of the dependencies for the assembly: 'Sentry'.
   At: modules/mono/editor/godotsharp_export.cpp:98.
</code></pre><p>Finding the answer to this little bugger took me a good two days of research,
trial and error, so I&rsquo;ll cut to the chase.</p>
<p>After digging through the <a href=https://github.com/getsentry/sentry-dotnet>.Net Sentry SDK</a> I found out that the <code>System.Web</code>
assembly (required by the <code>net461</code> variant of the <code>Sentry.dll</code> assembly) is not
a strict requirement, and that on other framework outputs its reference is
omitted.</p>
<p>So, on the last trial, I ended up <a href=https://github.com/mastern2k3/sentry-dotnet>forking the SDK</a> in an attempt to produce a
<code>Sentry.dll</code> that did not reference <code>System.Web</code>.</p>
<p>You can download a compiled version of it <a href=https://github.com/mastern2k3/sentry-dotnet/releases/tag/2.1.0-godot>here</a>.</p>
<p>Important: The example project references the compiled fork version so it
appears as such in the <code>.csproj</code> file:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;Reference</span> <span style=color:#a6e22e>Include=</span><span style=color:#e6db74>&#34;Sentry, Version=2.1.0.0&#34;</span><span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;HintPath&gt;</span>$(ProjectDir)/../forks/sentry-dotnet/src/Sentry/bin/Release/net461/Sentry.dll<span style=color:#f92672>&lt;/HintPath&gt;</span>
  <span style=color:#75715e>&lt;!-- &lt;HintPath&gt;$(ProjectDir)/packages/Sentry.2.1.0/lib/net461/Sentry.dll&lt;/HintPath&gt; --&gt;</span>
  <span style=color:#f92672>&lt;Private&gt;</span>True<span style=color:#f92672>&lt;/Private&gt;</span>
<span style=color:#f92672>&lt;/Reference&gt;</span>
</code></pre></div><p>If you&rsquo;re not interested in any of this Android nonsense you can comment /
uncomment whichever line fits your needs.</p>
<h2 id=other-sentry-related-stuff-you-should-check-out>Other Sentry related stuff you should check out<a hidden class=anchor aria-hidden=true href=#other-sentry-related-stuff-you-should-check-out>#</a></h2>
<ul>
<li>
<p><a href="https://docs.sentry.io/enriching-error-data/scopes/?platform=csharp">Sentry Scopes</a> - these enable you to add more info (like user identification)
as application usage progresses.</p>
</li>
<li>
<p><a href=https://docs.sentry.io/server/>Self hosting Sentry</a> - yeah, you can do that.</p>
</li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://gatomalo.dev/tags/godot/>godot</a></li>
<li><a href=https://gatomalo.dev/tags/sentry/>sentry</a></li>
<li><a href=https://gatomalo.dev/tags/monitoring/>monitoring</a></li>
<li><a href=https://gatomalo.dev/tags/error-monitoring/>error monitoring</a></li>
</ul>
</footer><div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//gato-malo.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://gatomalo.dev/>Gato Malo</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/mastern2k3/hugo-PaperMod-Nord rel=noopener target=_blank>PaperMod-Nord</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>